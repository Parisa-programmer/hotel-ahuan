"use strict";(self["webpackChunktest"]=self["webpackChunktest"]||[]).push([[6453],{6453:function(e,t,a){a.r(t),a.d(t,{default:function(){return P}});var l=a(37359),s=a(16190),i=a(79582),n=a(60266),r=a(34061),o=a(65005),c=a(65495),u=a(11713),h=a(5375),d=a(17808),f=function(){var e=this,t=e._self._c;return t("div",{staticClass:"mt-12 pt-12 heightAll relative"},[t(c.Z,{staticClass:"backImage",attrs:{height:"800",src:a(61125),alt:""}}),t(o.Z,{ref:"flightForm",attrs:{"lazy-validation":""}},[t(u.Z,{staticClass:"absolute heightAll widthAll pr-12 mr-12",staticStyle:{top:"-50px"},attrs:{align:"center"}},[t("div",{staticClass:"mr-12 pt-6 px-6 rounded-lg white",staticStyle:{"background-color":"rgba(255, 255, 255, 0.548)"}},[t(u.Z,{staticClass:"mt-6"},[t(n.Z,[t(d.Z,{staticClass:"rounded-xl",attrs:{label:"نام مسافر",outlined:"",rules:e.nameRules},model:{value:e.name,callback:function(t){e.name=t},expression:"name"}})],1),t(n.Z,[t(d.Z,{staticClass:"mr-4 rounded-xl",attrs:{label:"نام خانوادگی مسافر",rules:e.nameRules,outlined:""},model:{value:e.family,callback:function(t){e.family=t},expression:"family"}})],1)],1),t(u.Z,{staticClass:"mt-6"},[t(n.Z,{staticClass:"pb-2 pt-0 pl-2"},[t("div",{staticClass:"input-group relative font-small-xs form-control headerBoxFields",staticStyle:{"border-radius":"5px",height:"100%",background:"#fff"}},[t("date-picker",{ref:"date",staticClass:"heightAll red",attrs:{show:e.show,color:"red",format:"YYYY-MM-DD","clearable:":"",true:"",locale:"fa,en","locale-config":e.localeConfig,popover:"right","auto-submit":"",min:e.minDate,range:!1,outlined:""},on:{close:function(t){e.show=!1,e.changeDate1()}},model:{value:e.date,callback:function(t){e.date=t},expression:"date"}}),t("div",{staticClass:"cursorPointer heightAll d-inline-block font-small-xs widthAll showPopup absolute rounded-xl",staticStyle:{"z-index":"22",padding:"10px 4px",color:"#424242",top:"0",background:"#fff",border:"1px solid #a6a6a4"},on:{click:function(t){e.show=!e.show}}},[e._v(" "+e._s(e.date&&e.date.length?e.selectedDate:"انتخاب تاریخ")+" ")])],1)]),t(n.Z,{staticClass:"pr-3"},[t(d.Z,{staticClass:"widthAll rounded-xl",attrs:{label:"PNR",outlined:"",rules:e.emptyRules},model:{value:e.PNR,callback:function(t){e.PNR=t},expression:"PNR"}})],1)],1),t(u.Z,{staticClass:"mt-6"},[t(n.Z,[t(d.Z,{staticClass:"rounded-xl",attrs:{label:"شماره پرواز",outlined:"",rules:e.emptyRules},model:{value:e.flightNo,callback:function(t){e.flightNo=t},expression:"flightNo"}})],1),t(n.Z,[t(d.Z,{staticClass:"rounded-xl mx-2",attrs:{label:"شماره بلیط",outlined:"",rules:e.emptyRules},model:{value:e.ticketNo,callback:function(t){e.ticketNo=t},expression:"ticketNo"}})],1),t(n.Z,[t(h.Z,{staticClass:"rounded-xl",attrs:{items:e.airlines,outlined:"",rules:e.emptyRules,"append-icon":"mdi-semantic-web",label:"شرکت هواپیمایی"},model:{value:e.airline,callback:function(t){e.airline=t},expression:"airline"}})],1)],1),t(u.Z,{staticClass:"mt-6",attrs:{justify:"center"}},[t(s.Z,{attrs:{color:"green",outlined:""},on:{click:function(t){return e.printTicket()}}},[e._v("چاپ مجدد بلیط")]),t("span",{staticClass:"mx-1"}),t(s.Z,{attrs:{color:"purple lighten-1",outlined:"",loading:e.disabelRT},on:{click:function(t){return e.RT()}}},[e._v("بررسی وضعیت بلیط")]),t("span",{staticClass:"mx-1"}),t(s.Z,{attrs:{color:"red",outlined:"",loading:e.loadingPenulty},on:{click:function(t){return e.checkPenalty()}}},[e._v("کنسل کردن پرواز")]),t(s.Z,{attrs:{color:"green d-none",dark:""},on:{click:function(t){return e.cancellPnr()}}},[e._v("cancell PNR")])],1),t(u.Z,{attrs:{justify:"center"}},[t("span",{staticClass:"caption mt-4 mb-2 red--text",staticStyle:{"font-family":"Byekan !important"}},[e._v("توجه داشته باشید برای کنسل کردن هر بلیط باید جداگانه فرم را اجرا کنید.")])])],1)])],1),e.penultyDialog?t(r.Z,{attrs:{width:"500"},model:{value:e.penultyDialog,callback:function(t){e.penultyDialog=t},expression:"penultyDialog"}},[t(i.Z,{staticClass:"pa-4"},[t(u.Z,{staticClass:"ma-6"},[t("p",{staticClass:"answerText"},[e._v(" با توجه به زمان صدور بلیط شما میزان جریمه بلیط "),t("b",{staticClass:"red--text mx-1"},[e._v(e._s(e.separatePrice(e.newInformations.Penalty[0]))+" ریال")]),e._v(" و مبلغ بازگشتی به شما "),t("b",{staticClass:"red--text mx-2"},[e._v(e._s(e.separatePrice(e.newInformations.RefundedAmount[0]))+" ریال")]),e._v(" می‌باشد. ")])]),t(u.Z,[t(s.Z,{staticClass:"green ml-2 px-6",attrs:{outlined:"",dark:"",loading:e.loadingConfirmPenulty},on:{click:function(t){return e.checkPenaltyNow()}}},[e._v("تائید و ادامه")]),t(s.Z,{staticClass:"red px-8",attrs:{outlined:"",dark:"",loading:e.loadingConfirmPenulty},on:{click:function(t){e.penultyDialog=!1}}},[e._v("انصراف")])],1)],1)],1):e._e(),e.showAlert?t(l.Z,{staticClass:"white--text fixed",staticStyle:{bottom:"0",right:"10px","min-width":"200px","z-index":"4444444444444"},attrs:{dark:"",type:e.alertType}},[e._v(" "+e._s(e.alertText)+" ")]):e._e()],1)},p=[],m=a(6154);m.Z.defaults.headers.common["Client-Token"]="Ahuan-Wapi?123";var T={name:"cancell-flight",data(){return{disabelRT:!1,qrcodeValue:"https://example.com",penultyDialog:!1,showAlert:!1,alertType:"error",alertText:"",show:!1,localeConfig:{fa:{lang:{label:"شمسی"}}},minDate:(new Date).getFullYear()+"-"+((new Date).getMonth()+1)+"-"+(new Date).getDate(),name:"",family:"",date:"",PNR:"",flightNo:"",ticketNo:"",airline:{},selectedDate:"",airlines:[{text:"آتا",value:"PA",url:"ata",oc:"THR155",user:"THR155.WS",pass:"Ahuan1348"},{text:"کیش ایر",value:"Y9",url:"kishair",oc:"THR100",user:"THR100.WS",pass:"Ahuan1348"},{text:"قشم ایر",value:"QB",url:"qeshmair",oc:"THR166",user:"THR166.WS",pass:"Ahuan1348"},{text:"کاسپین",value:"IV",url:"caspian",oc:"THR100",user:"THR100.WS",pass:"Ahuan1348"},{text:"تابان",value:"HH",url:"taban",oc:"THR168",user:"THR168.WS",pass:"Ahuan1348"},{text:"ساها",value:"IRZ",url:"saha",oc:"THR140",user:"THR140.WS",pass:"123456789"},{text:"آسمان",value:"EP",url:"aseman",oc:"THR100",user:"THR100.WS",pass:"Ahuan1348"},{text:"زاگرس",value:"ZV",url:"zagros",oc:"THR197",user:"THR197.WS",pass:"Ahuan1348"},{text:"نفت",value:"NV",url:"naft",oc:"THR100",user:"THR100.WS",pass:"Ahuan1348"},{text:"معراج",value:"JI",url:"meraj",oc:"THR158",user:"THR158.WS",pass:"THR158AH"},{text:"وارش",value:"VR",url:"varesh",oc:"THR215",user:"THR215.WS",pass:"A2930"}],nameRules:[e=>!!e||"پر کردن فیلد نام اجباریست.",e=>(e||"").indexOf(0)<0||"فرمت صحیح نیست",e=>(e||"").indexOf(1)<0||"فرمت صحیح نیست",e=>(e||"").indexOf(2)<0||"فرمت صحیح نیست",e=>(e||"").indexOf(3)<0||"فرمت صحیح نیست",e=>(e||"").indexOf(4)<0||"فرمت صحیح نیست",e=>(e||"").indexOf(5)<0||"فرمت صحیح نیست",e=>(e||"").indexOf(6)<0||"فرمت صحیح نیست",e=>(e||"").indexOf(7)<0||"فرمت صحیح نیست",e=>(e||"").indexOf(8)<0||"فرمت صحیح نیست",e=>(e||"").indexOf(9)<0||"فرمت صحیح نیست",e=>!/^[\u0600-\u06FF\s]+$/.test(e)||"فرمت صحیح نیست"],familyRules:[e=>!!e||"پر کردن فیلد نام خانوادگی اجباریست.",e=>(e||"").indexOf(0)<0||"فرمت صحیح نیست",e=>(e||"").indexOf(1)<0||"فرمت صحیح نیست",e=>(e||"").indexOf(2)<0||"فرمت صحیح نیست",e=>(e||"").indexOf(3)<0||"فرمت صحیح نیست",e=>(e||"").indexOf(4)<0||"فرمت صحیح نیست",e=>(e||"").indexOf(5)<0||"فرمت صحیح نیست",e=>(e||"").indexOf(6)<0||"فرمت صحیح نیست",e=>(e||"").indexOf(7)<0||"فرمت صحیح نیست",e=>(e||"").indexOf(8)<0||"فرمت صحیح نیست",e=>(e||"").indexOf(9)<0||"فرمت صحیح نیست",e=>!/^[\u0600-\u06FF\s]+$/.test(e)||"فرمت صحیح نیست"],emptyRules:[e=>!!e||"پر کردن این فیلد اجباریست."],newInformations:{Fare:"",KU:"",LP:"",Penalty:[],RefundedAmount:[]},loadingPenulty:!1,loadingConfirmPenulty:!1}},components:{},computed:{},methods:{checkPenalty(){if(this.$refs.flightForm.validate()){let e=this;e.loadingPenulty=!0;let t=this.airlines.find((e=>e.value==this.airline));m.Z.get("http://localhost:8080/"+t.url+"/NRSPenalty.jsp?AirLine="+t.value+"&TicketNo="+this.ticketNo+"&OfficeUser="+t.user+"&OfficePass="+t.pass).then((function(t){console.log(t),t.data.NRSPenalty?(e.newInformations.Penalty=t.data.NRSPenalty.PENALTY.split("."),e.newInformations.RefundedAmount=t.data.NRSPenalty.RefundedAmount.split("."),e.penultyDialog=!0):(e.alertText="NO COUPON EXISTS FOR REFUND!!!\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n"==t.data?"این بلیط قبلا کنسل شده!":t.data,e.alertType="warning",e.showAlert=!0,setTimeout((()=>{e.showAlert=!1}),5e3)),e.loadingPenulty=!1})).catch((function(t){e.loadingPenulty=!1,console.log(t)}))}else this.alertText="لطفا فیلدهای درخواستی را بدرستی تکمیل فرمائید.",this.alertType="error",this.showAlert=!0,setTimeout((()=>{this.showAlert=!1}),3e3)},checkPenaltyNow(){if(this.$refs.flightForm.validate()){let e=this;e.loadingConfirmPenulty=!0;let t=this.airlines.find((e=>e.value==this.airline)),a={Airline:t.value,TicketNo:this.ticketNo,OfficeUser:t.user,OfficePass:t.pass};m.Z.get("http://localhost:8080/"+t.url+"/NRSPenaltyNow.jsp?",{params:a}).then((function(t){e.newInformations.Penalty=t.data.NRSPenalty.PENALTY;let a=t.data.NRSPenalty.RefundedTaxes.findIndex((e=>"LP"==e.TaxType));e.newInformations.LP=-1==a?"":t.data.NRSPenalty.RefundedTaxes[a].TaxAmount,e.newInformations.Penalty=t.data.NRSPenalty.PENALTY.split("."),e.newInformations.RefundedAmount=t.data.NRSPenalty.RefundedAmount.split("."),e.cancelSeat()})).catch((function(t){console.log(t),e.loadingConfirmPenulty=!1}))}else this.alertText="لطفا فیلدهای درخواستی را بدرستی تکمیل فرمائید.",this.alertType="error",this.showAlert=!0,setTimeout((()=>{this.showAlert=!1}),3e3)},cancelSeat(){if(this.$refs.flightForm.validate()){let e=this,t=this.airlines.find((e=>e.value==this.airline)),a={Airline:t.value,PNR:this.PNR,PassengerName:this.name,PassengerLastName:this.family,DepartureDate:this.date,FlightNo:this.flightNo,OfficeUser:t.user,OfficePass:t.pass};m.Z.get("http://localhost:8080/"+t.url+"2/CancelSeatJS",{params:a}).then((function(t){"true"==t.data.AirCancelSeat[0].Done?e.ETR():(e.alertType="error",e.alertText="عملیات با خطا مواجه شد.پس از اطمینان از درست بودن فیلدها، باپشتیبانی (داخلی 161) تماس حاصل فرمائید.",e.showAlert=!0,setTimeout((()=>{e.showAlert=!1}),3e3))})).catch((function(t){console.log(t),e.loadingConfirmPenulty=!1,e.alertType="error",e.alertText="عملیات با خطا مواجه شد.",e.showAlert=!0,setTimeout((()=>{e.showAlert=!1}),3e3)}))}else this.alertText="لطفا فیلدهای درخواستی را بدرستی تکمیل فرمائید.",this.alertType="error",this.showAlert=!0,setTimeout((()=>{this.showAlert=!1}),3e3)},printTicket(e){if(this.$refs.flightForm.validate()){let e=this.airlines.find((e=>e.value==this.airline));window.open("http://localhost:8080/"+e.url+"3/TicketPrint.aspx?PNR="+this.PNR+"&TicketNo="+this.ticketNo+"&OC="+e.oc,"_blank")}else this.alertText="لطفا فیلدهای درخواستی را بدرستی تکمیل فرمائید.",this.alertType="error",this.showAlert=!0,setTimeout((()=>{this.showAlert=!1}),3e3)},ETR(){if(this.$refs.flightForm.validate()){let e=this,t=this.airlines.find((e=>e.value==this.airline));m.Z.get("http://localhost:8080/"+t.url+"/NRSETR.jsp?Airline="+t.value+"&TicketNo="+this.ticketNo+"&OfficeUser="+t.user+"&OfficePass="+t.pass).then((function(t){e.newInformations.Fare=t.data.Fare;let a=t.data.TAXES.find((e=>"KU"==e.TaxCode));e.newInformations.KU==a&&a.TaxAmount;let l=t.data.TAXES.find((e=>"LP"==e.TaxCode));e.newInformations.LP==l&&l.TaxAmount,e.ETRefund()})).catch((function(e){console.log(e)}))}else this.alertText="لطفا فیلدهای درخواستی را بدرستی تکمیل فرمائید.",this.alertType="error",this.showAlert=!0,setTimeout((()=>{this.showAlert=!1}),3e3)},RT(){if(this.$refs.flightForm.validate()){let e=this;e.disabelRT=!0;let t=this.airlines.find((e=>e.value==this.airline));m.Z.get("http://localhost:8080/"+t.url+"/NRSRT.jsp?Airline="+t.value+"&PNR="+this.PNR+"&OfficeUser="+t.user+"&OfficePass="+t.pass+"&Complete=y").then((function(t){let a=t.data.Tickets.find((t=>t.PassengerET.toLowerCase()==e.family.toLowerCase()+"/"+e.name.toLowerCase()+":"+e.ticketNo));a?(e.alertType="O"==a.ETStatus?"success":"R"==a.ETStatus?"error":"warning",e.alertText="O"==a.ETStatus?"بلیط اکتیو می‌باشد":"R"==a.ETStatus?"بلیط کنسل شده.":"ETStatus = "+a.ETStatus):(e.alertType="warning",e.alertText="اطلاعات وارد شده صحیح نمی‌باشد."),e.showAlert=!0,e.disabelRT=!1,setTimeout((()=>{e.showAlert=!1}),3e3)})).catch((function(e){console.log(e)}))}else this.alertText="لطفا فیلدهای درخواستی را بدرستی تکمیل فرمائید.",this.alertType="error",this.showAlert=!0,setTimeout((()=>{this.showAlert=!1}),3e3)},ETRefund(){if(this.$refs.flightForm.validate()){let e=this,t=this.airlines.find((e=>e.value==this.airline)),a={Airline:t.value,TicketNo:this.ticketNo,Fare:e.newInformations.Fare,KU:e.newInformations.KU,LP:e.newInformations.LP,Penalty:e.newInformations.Penalty[0],OfficeUser:t.user,OfficePass:t.pass};m.Z.get("http://localhost:8080/"+t.url+"2/ETRefundJS",{params:a}).then((function(t){e.alertType="success",e.alertText="پرواز انتخابی با موفقیت کنسل شد.",e.showAlert=!0,e.penultyDialog=!1,e.loadingConfirmPenulty=!1,setTimeout((()=>{e.showAlert=!1}),3e3)})).catch((function(e){console.log(e)}))}else this.alertText="لطفا فیلدهای درخواستی را بدرستی تکمیل فرمائید.",this.alertType="error",this.showAlert=!0,setTimeout((()=>{this.showAlert=!1}),3e3)},changeDate1(e){let t=e||this.$refs.date.value,a="",l={day:"numeric",month:"long"};a=2==t.length?new Date(t[0]).toLocaleDateString("fa-IR",l)+" الی "+new Date(t[1]).toLocaleDateString("fa-IR",l):new Date(t).toLocaleDateString("fa-IR",l),this.selectedDate=a,console.log(a)},cancellPnr(){if(this.$refs.flightForm.validate()){let e=this.airlines.find((e=>e.value==this.airline)),t={Airline:e.value,PNR:this.PNR,OfficeUser:e.user,OfficePass:e.pass};m.Z.get("http://localhost:8080/"+e.url+"2/CancelPNRJS",{params:t}).then((function(e){e.data.AirCancelPNR?"Already Cancelled"==e.data.AirCancelPNR[0].Error&&console.log("قبلا کنسل شده این PNR"):"No Error COMMAND--CANCELLATION DENIED AFTER FLIGHT STOP BOOK.--"==JSON.parse(e.data.replace(/[\r\n]/gm,"-")).AirCancelPNR[0].Error?console.log("امکان کنسل کردن بعد از پرواز وجود ندارد."):"No Error COMMAND--NO PNR--"==JSON.parse(e.data.replace(/[\r\n]/gm,"-")).AirCancelPNR[0].Error?console.log("PNR وارد شده صحیح نیست."):"No Error COMMAND--PNR CANCELLED--"==JSON.parse(e.data.replace(/[\r\n]/gm,"-")).AirCancelPNR[0].Error&&console.log("PNR با موفقیت کنسل شد.");e.data})).catch((function(e){console.log(e)}))}else this.alertText="لطفا فیلدهای درخواستی را بدرستی تکمیل فرمائید.",this.alertType="error",this.showAlert=!0,setTimeout((()=>{this.showAlert=!1}),3e3)},separatePrice(e){let t=e.toString().replace(/,/g,""),a=t;return a=0==t.length||t<0?0:t.length>1&&0==t[0]?t.replace(0,""):t.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","),a}},created(){window.scrollTo(0,0)}},g=T,x=a(1001),R=(0,x.Z)(g,f,p,!1,null,"4b51bba8",null),P=R.exports},61125:function(e,t,a){e.exports=a.p+"img/cancell-flight.b225a24c.jpg"}}]);
//# sourceMappingURL=6453.8df10aeb.js.map